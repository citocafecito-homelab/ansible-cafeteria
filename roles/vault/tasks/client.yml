- name: Add Vault Config to /etc/bash.bashrc (for all users)
  become: true
  ansible.builtin.blockinfile:
    path: /etc/bash.bashrc
    block: |
      export VAULT_ADDR="{{ vault_addr }}"
    marker: "# {mark} ANSIBLE VAULT BLOCK"

- name: Set Vault token in a global location
  become: true
  ansible.builtin.copy:
    dest: "/etc/vault-token"
    content: "{{ vault_root_token }}"
    mode: '0600'  # Aseg√∫rate de que solo los usuarios autorizados tengan acceso

- name: Add Vault Config to /etc/profile.d/vault.sh (for all users)
  become: true
  ansible.builtin.copy:
    dest: /etc/profile.d/vault.sh
    content: |
      export VAULT_ADDR="{{ vault_addr }}"
    mode: '0755'
