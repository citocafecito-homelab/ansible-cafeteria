# ------------------------------------------------------------------------------
# Workstation Setup
#
# This play configures a developer workstation using optional, flag-based roles.
#
# ðŸ§ª Local testing
# To run this playbook safely on localhost for testing purposes:
#
#   1. Use the test inventory:
#        ansible-playbook playbooks/main.yml -i inventory.test.ini
#
#   2. Enable/disable roles explicitly in:
#        host_vars/localhost.yml
#
# Only roles with `<role>_enabled: true` will be executed.
# This prevents destructive or unwanted changes during local testing.
# ------------------------------------------------------------------------------
- name: Workstation Setup
  hosts: workstation
  gather_facts: true
  tasks:
    - name: Install Deps
      become: true
      ansible.builtin.package:
        name:
          - kubectl
          - git
        state: present
  roles:
    # System
    - { role: bluetooth, when: bluetooth_enabled | default(false) | bool }
    - { role: nfs, when: nfs_enabled | default(false) | bool }

    # Secret manager
    - { role: vault, when: vault_enabled | default(false) | bool }

    # Development Tools
    - { role: gh, when: gh_enabled | default(false) | bool }
    - { role: nodejs, when: nodejs_enabled | default(false) | bool }
