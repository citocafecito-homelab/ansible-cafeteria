# ------------------------------------------------------------------------------
# Workstation Setup
#
# This play configures a developer workstation using optional, flag-based roles.
#
# ðŸ§ª Local testing
# To run this playbook safely on localhost for testing purposes:
#
#   1. Use the test inventory:
#        ansible-playbook playbooks/main.yml -i inventory.test.ini
#
#   2. Enable/disable roles explicitly in:
#        host_vars/localhost.yml
#
# Only roles with `<role>_enabled: true` will be executed.
# This prevents destructive or unwanted changes during local testing.
# ------------------------------------------------------------------------------
- name: Workstation Setup
  hosts: workstation
  gather_facts: true
  pre_tasks:
    - name: Print OS Information
      ansible.builtin.debug:
        msg:
          - "Distro: {{ ansible_distribution_release }}"
          - "Version: {{ ansible_distribution_version }}"
          - "Codename: {{ ansible_distribution_release }}"

    - name: Install App
      become: true
      ansible.builtin.apt:
        name:
          - apt-transport-https
          - ca-certificates
          - gnupg
        state: present
        update_cache: true
      when: ansible_os_family == "Debian"
    
    # TODO
    # ujust bazzite-cli 
  tasks: []

  roles:
    # System
    - { role: bluetooth, when: bluetooth_enabled | default(false) | bool }
    - { role: nfs, when: nfs_enabled | default(false) | bool }

    # Development Tools
    - { role: dev_tools, when: dev_tools_enabled | default(false) | bool }
    - { role: vault, when: vault_enabled | default(false) | bool }

    # VM / Containers
    - { role: vmware, when: vmware_enabled | default(false) | bool }

    # User Apps
    # - { role: steam, when: steam_enabled | default(false) | bool }
    - { role: supersonic, when: supersonic_enabled | default(false) | bool }
